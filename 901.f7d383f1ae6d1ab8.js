"use strict";(self.webpackChunkZenTech=self.webpackChunkZenTech||[]).push([[901],{9742:(P,y,n)=>{n.d(y,{p:()=>r});var _=n(9291),Y=n(6434),h=n(132),e=n(2425);let r=(()=>{class Z{constructor(T,C,p){this.accountService=T,this.router=C,this.toastr=p}canActivate(T,C){let p=this.accountService.accountValue;return p?!(T.data.roles&&!T.data.roles.includes(p?.role)&&(this.toastr.error("Acesso n\xe3o autorizado."),this.router.navigate([""]),1)):(this.toastr.error("Acesso n\xe3o autorizado. <br> Fa\xe7a login."),this.router.navigate(["account","login"],{queryParams:{returnUrl:C.url}}),!1)}static#e=this.\u0275fac=function(C){return new(C||Z)(_.LFG(Y.B),_.LFG(h.F0),_.LFG(e._W))};static#t=this.\u0275prov=_.Yz7({token:Z,factory:Z.\u0275fac,providedIn:"root"})}return Z})()},2901:(P,y,n)=>{n.r(y),n.d(y,{UsuariosModule:()=>st});var _=n(6814),Y=n(5592),h=n(490),e=n(9291),r=n(6434),Z=n(9862),w=n(5619),T=n(9397),C=n(2096),p=n(2832),S=n(5219);class O{constructor(){this.id=0,this.perfilAcesso=void 0,this.perfilAcesso_Id=void 0,this.name="",this.email="",this.telefoneCelular="",this.empresa_Id=0}}var L=[{field:"id",header:"Id",maskType:p.O.undefined,filterType:p.vA.text,filterDisplay:p.w2.menu,showAddButton:!1,showMatchMode:!1,showOperator:!1,filterMatchMode:S.a6.EQUALS},{field:"name",header:"Nome",filterType:p.vA.text,filterDisplay:p.w2.menu,maskType:p.O.substring,substringLength:22,showAddButton:!1,showMatchMode:!1,showOperator:!1,filterMatchMode:S.a6.CONTAINS},{field:"email",header:"E-mail",filterType:p.vA.text,filterDisplay:p.w2.menu,maskType:p.O.substring,substringLength:30,showAddButton:!1,showMatchMode:!1,showOperator:!1,filterMatchMode:S.a6.CONTAINS},{field:"telefoneCelular",header:"Telefone/Celular",filterType:p.vA.text,filterDisplay:p.w2.menu,maskType:p.O.undefined,showAddButton:!1,showMatchMode:!1,showOperator:!1,filterMatchMode:S.a6.CONTAINS},{field:"perfilAcesso.perfil",header:"Tipo de Acesso",maskType:p.O.options,filterType:p.vA.text,filterDisplay:p.w2.menu,showAddButton:!1,showMatchMode:!1,showOperator:!1,filterMatchMode:S.a6.EQUALS,values:[{value:"Admin",output:"Admin",class:"flag-yellow"},{value:"Master",output:"Master",class:"flag-info"}]},{field:"ativo",header:"Ativo",maskType:p.O.options,filterType:p.vA.text,filterDisplay:p.w2.menu,showAddButton:!1,showMatchMode:!1,showOperator:!1,filterMatchMode:S.a6.EQUALS,values:[{value:!0,output:"Ativo",class:"flag-green"},{value:!1,output:"Inativo",class:"flag-danger"}]}],Q=n(553),m=n(697),U=n(8787),c=n(2425),d=n(2667),f=n(5038);let g=(()=>{class i{constructor(t,s,o,a,u,M){this.table=t,this.http=s,this.toastr=o,this.crypto=a,this.accountService=u,this.empresaService=M,this.url=Q.N.url,this.list=new w.X([]),this.objeto=new w.X(void 0),this.account=new m.mR,this.perfilAcesso=new w.X([]),this.loading=new w.X(!1),this.accountService.account.subscribe(N=>this.account=N??new m.mR)}getObject(){var t=localStorage.getItem("usuario");return t&&this.setObject(this.crypto.decrypt(t)??new O),this.objeto}setObject(t){localStorage.setItem("usuario",this.crypto.encrypt(t)??""),this.objeto.next(t)}getList(t=!1){return this.loading.next(t),this.table.loading.next(!0),this.http.get(`${this.url}/usuario/list/${this.empresaService.empresaSelected.value.id}`).pipe((0,T.b)({next:o=>(o=o.map(a=>(a.ativo=!a.dataDesativado,a)),this.list.next(o),this.loading.next(!1),(0,C.of)(o)),error:o=>this.toastr.error("N\xe3o foi poss\xedvel carregar usu\xe1rios."),finalize:()=>this.loading.next(!1)}))}get(t){return this.http.get(`${this.url}/usuario/${t}`,{headers:new Z.WM({loading:"true"})})}getPerfilAcesso(){return this.http.get(`${this.url}/perfilAcesso/getAll`).pipe((0,T.b)({next:t=>(this.perfilAcesso.next(t),t),error:t=>this.toastr.error("N\xe3o foi poss\xedvel carregar perfil.")}))}create(t){return t.empresa_Id=this.empresaService.empresaSelected.value.id,this.http.post(`${this.url}/usuario`,t)}edit(t){return t.empresa_Id=this.empresaService.empresaSelected.value.id,this.http.put(`${this.url}/usuario`,t)}delete(t){return this.http.delete(`${this.url}/usuario/${t}`)}deactivated(t,s){return this.http.patch(`${this.url}/usuario/${t}/${s}`,{})}resetPassword(t){return this.http.patch(`${this.url}/usuario/reset-password/${t}`,{})}static#e=this.\u0275fac=function(s){return new(s||i)(e.LFG(U.i),e.LFG(Z.eN),e.LFG(c._W),e.LFG(d.w),e.LFG(r.B),e.LFG(f.P))};static#t=this.\u0275prov=e.Yz7({token:i,factory:i.\u0275fac,providedIn:"root"})}return i})();var v=n(132);let A=(()=>{class i{constructor(t,s,o,a){this.accountService=t,this.userService=s,this.router=o,this.toastr=a}canActivate(t,s){return new Y.y(o=>{this.userService.objeto.subscribe(a=>{var u=this.accountService.accountValue;o.next(u?.perfilAcesso_Id!=h.uU.Master||a?.perfilAcesso_Id!=h.uU.Admin)})})}static#e=this.\u0275fac=function(s){return new(s||i)(e.LFG(r.B),e.LFG(g),e.LFG(v.F0),e.LFG(c._W))};static#t=this.\u0275prov=e.Yz7({token:i,factory:i.\u0275fac,providedIn:"root"})}return i})();var R=n(5861),D=n(590),x=n(708),W=n(6599),K=n(9901),F=n(5597);function V(i,l){if(1&i&&(e.TgZ(0,"p",13)(1,"small"),e._uU(2,"Usu\xe1rios cadastrados em "),e.TgZ(3,"strong"),e._uU(4),e.qZA()()()),2&i){const t=e.oxw();e.xp6(4),e.Oqu(t.empresaSelected.nome||"Empresa X")}}function H(i,l){1&i&&e._UZ(0,"span",14)}const $=function(){return["cadastrar"]};function z(i,l){1&i&&(e.TgZ(0,"div",15)(1,"a",16)(2,"span",17),e._uU(3," Cadastrar Usu\xe1rio"),e.qZA()()()),2&i&&(e.xp6(1),e.Q6J("routerLink",e.DdM(1,$)))}let X=(()=>{class i{constructor(t,s,o,a){var u=this;this.table=t,this.userService=s,this.accountService=o,this.empresaService=a,this.faUsers=D.FVb,this.list=[],this.tableLinks=[],this.columns=L,this.subscription=[],this.loading=!1;var M=this.userService.list.subscribe(E=>this.list=Object.assign([],E));this.subscription.push(M);var N=this.userService.loading.subscribe(E=>this.loading=E);this.subscription.push(N);var ot=this.empresaService.empresaSelected.subscribe(function(){var E=(0,R.Z)(function*(J){u.empresaSelected=J.empresa,J&&J.id&&(yield(0,x.n)(u.userService.getList(!0)))});return function(J){return E.apply(this,arguments)}}());this.subscription.push(ot),(0,x.n)(this.userService.getList(!0));var at=this.table.selected.subscribe(E=>{E&&(this.tableLinks=[{label:"Editar",routePath:["editar"],paramsFieldName:["id"]},{label:E.ativo?"Desabilitar":"Habilitar",routePath:[E.ativo?"desabilitar":"habilitar"],paramsFieldName:["id"]},{label:"Resetar senha",routePath:["reset-password"],paramsFieldName:["id"]}],1==this.accountService.accountValue?.perfilAcesso_Id&&this.tableLinks.push({label:"Excluir",routePath:["excluir"],paramsFieldName:["id"]}),this.tableLinks=this.table.encryptParams(this.tableLinks))});this.subscription.push(at)}ngOnDestroy(){this.subscription.forEach(t=>t.unsubscribe())}getList(){(0,x.n)(this.userService.getList(!0))}static#e=this.\u0275fac=function(s){return new(s||i)(e.Y36(U.i),e.Y36(g),e.Y36(r.B),e.Y36(f.P))};static#t=this.\u0275cmp=e.Xpm({type:i,selectors:[["app-list"]],decls:18,vars:14,consts:[[1,"page"],[1,"page__header"],[1,"title-icon","align-items-center"],[3,"icon"],[1,"me-auto"],[1,"page__header-title"],["class","page__header-subtitle",4,"ngIf"],[1,"ms-auto","mt-auto",2,"margin-bottom","7px"],[1,"btn","btn-dark",3,"disabled","click"],["class","spinner-border spinner-border-sm me-1",4,"ngIf"],[1,"page__body"],["topActions",""],[3,"list","topActions","filterLink","filterTable","paginator","sortTable","menuTable","columns","tableLinks","selectable"],[1,"page__header-subtitle"],[1,"spinner-border","spinner-border-sm","me-1"],[1,"col-xl-4","col-lg-4","col-md-4","col-sm-6","col-12","mb-2","me-md-2","mx-md-1","px-0","ng-star-inserted"],[1,"btn","btn-primary","d-flex","align-items-center","align-baseline","justify-content-center","me-md-0","me-sm-1",3,"routerLink"],[2,"margin-top","-1px","margin-bottom","1px"]],template:function(s,o){if(1&s&&(e.TgZ(0,"section",0)(1,"div",1)(2,"span",2),e._UZ(3,"fa-icon",3),e.qZA(),e.TgZ(4,"div",4)(5,"h3",5),e._uU(6,"Usu\xe1rios"),e.qZA(),e.YNc(7,V,5,1,"p",6),e.qZA(),e.TgZ(8,"div",7)(9,"button",8),e.NdJ("click",function(){return o.getList()}),e.YNc(10,H,1,0,"span",9),e._uU(11,"Atualizar"),e.qZA()(),e._UZ(12,"app-empresa-selected"),e.qZA(),e.TgZ(13,"div",10),e.YNc(14,z,4,2,"ng-template",null,11,e.W1O),e._UZ(16,"app-list-shared",12),e.qZA()(),e._UZ(17,"router-outlet")),2&s){const a=e.MAs(15);e.xp6(3),e.Q6J("icon",o.faUsers),e.xp6(4),e.Q6J("ngIf",o.empresaSelected),e.xp6(2),e.Q6J("disabled",o.loading),e.xp6(1),e.Q6J("ngIf",o.loading),e.xp6(6),e.Q6J("list",o.list)("topActions",a)("filterLink",!1)("filterTable",!0)("paginator",!0)("sortTable",!0)("menuTable",!0)("columns",o.columns)("tableLinks",o.tableLinks)("selectable",!0)}},dependencies:[_.O5,v.lC,v.rH,W.o,K.j,F.BN]})}return i})();var I=n(2855),B=n(342),b=n(6223);const k=["template"],ee=["icon"];function te(i,l){if(1&i&&e._UZ(0,"fa-icon",2),2&i){const t=e.oxw();e.Q6J("icon",t.faUser)}}function ie(i,l){1&i&&(e.TgZ(0,"p",9),e._uU(1,"Este campo \xe9 obrigat\xf3rio."),e.qZA())}function se(i,l){1&i&&(e.TgZ(0,"span"),e._uU(1,"Remova os espa\xe7os antes e depois do texto."),e.qZA())}function oe(i,l){if(1&i&&(e.TgZ(0,"p",9),e.YNc(1,se,2,0,"span",12),e.qZA()),2&i){e.oxw(2);const t=e.MAs(10);e.xp6(1),e.Q6J("ngIf","^\\S(.*\\S)?$"==t.errors.pattern.requiredPattern)}}function ae(i,l){if(1&i&&(e.TgZ(0,"div"),e.YNc(1,ie,2,0,"p",26),e.YNc(2,oe,2,1,"p",26),e.qZA()),2&i){e.oxw();const t=e.MAs(10);e.xp6(1),e.Q6J("ngIf",t.errors.required),e.xp6(1),e.Q6J("ngIf",t.errors.pattern)}}function ne(i,l){1&i&&(e.TgZ(0,"p",9),e._uU(1,"Este campo \xe9 obrigat\xf3rio."),e.qZA())}function re(i,l){1&i&&(e.TgZ(0,"p",9),e._uU(1,"Telefone/celular inv\xe1lido"),e.qZA())}function le(i,l){if(1&i&&(e.TgZ(0,"div"),e.YNc(1,ne,2,0,"p",26),e.YNc(2,re,2,0,"p",26),e.qZA()),2&i){e.oxw();const t=e.MAs(18);e.xp6(1),e.Q6J("ngIf",t.errors.required),e.xp6(1),e.Q6J("ngIf",t.errors.mask)}}function ce(i,l){if(1&i&&(e.TgZ(0,"option",19),e._uU(1),e.qZA()),2&i){const t=l.$implicit;e.Q6J("ngValue",t.id),e.xp6(1),e.Oqu(t.perfil)}}function ue(i,l){1&i&&(e.TgZ(0,"p",9),e._uU(1,"Este campo \xe9 obrigat\xf3rio."),e.qZA())}function pe(i,l){if(1&i&&(e.TgZ(0,"div"),e.YNc(1,ue,2,0,"p",26),e.qZA()),2&i){e.oxw();const t=e.MAs(26);e.xp6(1),e.Q6J("ngIf",t.errors.required)}}function de(i,l){1&i&&(e.TgZ(0,"p",9),e._uU(1,"Este campo \xe9 obrigat\xf3rio."),e.qZA())}function me(i,l){1&i&&(e.TgZ(0,"p",9),e._uU(1,"E-mail inv\xe1lido"),e.qZA())}function _e(i,l){if(1&i&&(e.TgZ(0,"div"),e.YNc(1,de,2,0,"p",26),e.YNc(2,me,2,0,"p",26),e.qZA()),2&i){e.oxw();const t=e.MAs(37);e.xp6(1),e.Q6J("ngIf",t.errors.required),e.xp6(1),e.Q6J("ngIf",t.errors.email)}}function he(i,l){if(1&i&&(e.TgZ(0,"p",9),e._uU(1),e.ALo(2,"json"),e.qZA()),2&i){const t=l.$implicit;e.xp6(1),e.Oqu(e.lcZ(2,1,t))}}function fe(i,l){1&i&&(e.TgZ(0,"p",9),e._uU(1,"Preencha todos os campos obrigat\xf3rios (*) corretamente para salvar"),e.qZA())}function ge(i,l){if(1&i&&(e.TgZ(0,"div",31),e.YNc(1,he,3,3,"p",32),e.YNc(2,fe,2,0,"p",26),e.qZA()),2&i){e.oxw(2);const t=e.MAs(1),s=e.oxw();e.xp6(1),e.Q6J("ngForOf",s.erro),e.xp6(1),e.Q6J("ngIf",t.invalid&&0==s.erro.length)}}function ve(i,l){1&i&&e._UZ(0,"span",33)}function xe(i,l){if(1&i&&(e.TgZ(0,"div",27),e.YNc(1,ge,3,2,"div",28),e.TgZ(2,"button",29),e.YNc(3,ve,1,0,"span",30),e.TgZ(4,"span"),e._uU(5,"Salvar"),e.qZA()()()),2&i){e.oxw();const t=e.MAs(1),s=e.oxw();e.xp6(1),e.Q6J("ngIf",s.erro||t.invalid),e.xp6(1),e.Q6J("disabled",t.invalid||s.loading||!s.podeEditar),e.xp6(1),e.Q6J("ngIf",s.loading)}}function be(i,l){if(1&i){const t=e.EpF();e.TgZ(0,"form",3,4),e.NdJ("ngSubmit",function(){e.CHM(t);const o=e.MAs(1),a=e.oxw();return e.KtG(a.send(o))}),e.TgZ(2,"div",5)(3,"div",6)(4,"div",7)(5,"label",8),e._uU(6,"Nome: "),e.TgZ(7,"span",9),e._uU(8,"*"),e.qZA()(),e.TgZ(9,"input",10,11),e.NdJ("ngModelChange",function(o){e.CHM(t);const a=e.oxw();return e.KtG(a.objeto.name=o)})("change",function(){e.CHM(t);const o=e.MAs(10),a=e.oxw();return e.KtG(a.objeto.name=o.value.trim())}),e.qZA(),e.YNc(11,ae,3,2,"div",12),e.qZA(),e.TgZ(12,"div",7)(13,"label",13),e._uU(14,"Telefone/Celular: "),e.TgZ(15,"span",9),e._uU(16,"*"),e.qZA()(),e.TgZ(17,"input",14,15),e.NdJ("ngModelChange",function(o){e.CHM(t);const a=e.oxw();return e.KtG(a.objeto.telefoneCelular=o)}),e.qZA(),e.YNc(19,le,3,2,"div",12),e.qZA(),e.TgZ(20,"div",7)(21,"label",16),e._uU(22,"Perfil: "),e.TgZ(23,"span",9),e._uU(24,"*"),e.qZA()(),e.TgZ(25,"select",17,18),e.NdJ("ngModelChange",function(o){e.CHM(t);const a=e.oxw();return e.KtG(a.objeto.perfilAcesso_Id=o)}),e.TgZ(27,"option",19),e._uU(28,"Selecione"),e.qZA(),e.YNc(29,ce,2,2,"option",20),e.qZA(),e.YNc(30,pe,2,1,"div",12),e.qZA(),e.TgZ(31,"div",21)(32,"label",22),e._uU(33,"E-mail: "),e.TgZ(34,"span",9),e._uU(35,"*"),e.qZA()(),e.TgZ(36,"input",23,24),e.NdJ("ngModelChange",function(o){e.CHM(t);const a=e.oxw();return e.KtG(a.objeto.email=o)}),e.qZA(),e.YNc(38,_e,3,2,"div",12),e.qZA()(),e.TgZ(39,"div",6),e.YNc(40,xe,6,3,"div",25),e.qZA()()()}if(2&i){const t=e.MAs(10),s=e.MAs(18),o=e.MAs(26),a=e.MAs(37),u=e.oxw();e.xp6(9),e.Q6J("ngModel",u.objeto.name)("disabled",!u.podeEditar),e.xp6(2),e.Q6J("ngIf",t.touched&&t.errors),e.xp6(6),e.Q6J("ngModel",u.objeto.telefoneCelular)("disabled",!u.podeEditar),e.xp6(2),e.Q6J("ngIf",s.touched&&s.errors),e.xp6(6),e.Q6J("ngModel",u.objeto.perfilAcesso_Id)("disabled",!u.podeEditar),e.xp6(2),e.Q6J("ngValue",void 0),e.xp6(2),e.Q6J("ngForOf",u.perfil),e.xp6(1),e.Q6J("ngIf",o.touched&&o.errors),e.xp6(6),e.Q6J("email",!0)("ngModel",u.objeto.email)("readonly",u.isEditPage)("pattern",u.emailPattern)("disabled",!u.podeEditar),e.xp6(2),e.Q6J("ngIf",a.touched&&a.errors),e.xp6(2),e.Q6J("ngIf",u.podeEditar)}}let q=(()=>{class i{constructor(t,s,o,a,u,M){this.usuarioService=t,this.modalService=s,this.activatedRoute=o,this.crypto=a,this.accountService=u,this.toastr=M,this.faUser=D.ILF,this.objeto=new O,this.loading=!1,this.erro="",this.isEditPage=!1,this.perfil=[],this.subscription=[],this.emailPattern=/^(([^<>()[\]\.,;:\s@\"]+(\.[^<>()[\]\.,;:\s@\"]+)*)|(\".+\"))@(([^<>()[\]\.,;:\s@\"]+\.)+[^<>()[\]\.,;:\s@\"]{2,})$/i,this.modal=new I.u,this.podeEditar=!0,this.perfil=h.JH,this.account=this.accountService.accountValue,this.perfil=this.account?.perfilAcesso_Id==h.uU.Master?[{id:2,perfil:"Master"}]:[{id:1,perfil:"Admin"},{id:2,perfil:"Master"}]}ngOnDestroy(){this.subscription.forEach(t=>t.unsubscribe())}ngAfterViewInit(){this.modal.id=0,this.modal.template=this.template,this.modal.icon=this.icon,this.modal.style={"max-width":"900px",overflow:"visible"},this.modal.activatedRoute=this.activatedRoute,this.modal.routerBackOptions={relativeTo:this.activatedRoute};var t=this.activatedRoute.params.subscribe(s=>{s.usuario_id?(this.objeto.id=this.crypto.decrypt(s.usuario_id),this.modal.title="Editar Usu\xe1rio",this.modal.routerBack=["../../"],this.isEditPage=!0,(0,x.n)(this.usuarioService.get(this.objeto.id)).then(o=>{this.objeto=o,this.account?.perfilAcesso_Id==h.uU.Master&&o.perfilAcesso_Id==h.uU.Admin&&(this.podeEditar=!1,this.toastr.info("Voc\xea n\xe3o tem permiss\xe3o para editar uma conta administradora.")),setTimeout(()=>{this.modal=this.modalService.addModal(this.modal,"usuario")},200)}).catch(o=>{this.voltar()})):(this.modal.title="Cadastrar Usu\xe1rio",this.modal.routerBack=["../"],this.isEditPage=!1,setTimeout(()=>{this.modal=this.modalService.addModal(this.modal,"usuario")},200))});this.subscription.push(t)}voltar(){this.modalService.removeModal(this.modal)}send(t){var s=this;this.loading=!0,this.erro="",this.request().then(function(){var o=(0,R.Z)(function*(a){yield(0,x.n)(s.usuarioService.getList()),s.voltar()});return function(a){return o.apply(this,arguments)}}()).catch(o=>{this.erro=(0,B.b)(o)}).finally(()=>this.loading=!1),console.log(this.objeto)}request(){return(0,x.n)(0==this.objeto.id?this.usuarioService.create(this.objeto):this.usuarioService.edit(this.objeto))}static#e=this.\u0275fac=function(s){return new(s||i)(e.Y36(g),e.Y36(I.Z),e.Y36(v.gz),e.Y36(d.w),e.Y36(r.B),e.Y36(c._W))};static#t=this.\u0275cmp=e.Xpm({type:i,selectors:[["app-form"]],viewQuery:function(s,o){if(1&s&&(e.Gf(k,5),e.Gf(ee,5)),2&s){let a;e.iGM(a=e.CRH())&&(o.template=a.first),e.iGM(a=e.CRH())&&(o.icon=a.first)}},decls:5,vars:0,consts:[["icon",""],["template",""],[3,"icon"],[3,"ngSubmit"],["form","ngForm"],[1,"px-2"],[1,"row"],[1,"form-group","col-xl-4","col-lg-4","col-md-6","col-sm-6","col-12"],["for","name"],[1,"text-danger"],["type","text","name","name","id","name","required","","pattern","\\S(.*\\S)?",1,"form-control",3,"ngModel","disabled","ngModelChange","change"],["name","ngModel"],[4,"ngIf"],["for","telefoneCelular"],["type","text","name","telefoneCelular","id","telefoneCelular","required","",1,"form-control",3,"ngModel","disabled","ngModelChange"],["telefoneCelular","ngModel"],["for","perfilAcesso_Id"],["name","perfilAcesso_Id","id","perfilAcesso_Id","required","",1,"form-control",3,"ngModel","disabled","ngModelChange"],["perfilAcesso_Id","ngModel"],[3,"ngValue"],[3,"ngValue",4,"ngFor","ngForOf"],[1,"form-group","col-xl-12","col-lg-12","col-md-6","col-sm-6","col-12","email-container"],["for","email"],["type","email","name","email","id","email","placeholder","example@hotmail.com","required","",1,"form-control",3,"email","ngModel","readonly","pattern","disabled","ngModelChange"],["email","ngModel"],["class","d-flex align-items-start flex-wrap mt-2 mb-1",4,"ngIf"],["class","text-danger",4,"ngIf"],[1,"d-flex","align-items-start","flex-wrap","mt-2","mb-1"],["class","m-0",4,"ngIf"],[1,"btn","btn-primary","me-0","ms-auto",3,"disabled"],["class","spinner-border spinner-border-sm me-1",4,"ngIf"],[1,"m-0"],["class","text-danger",4,"ngFor","ngForOf"],[1,"spinner-border","spinner-border-sm","me-1"]],template:function(s,o){1&s&&(e.YNc(0,te,1,1,"ng-template",null,0,e.W1O),e.YNc(2,be,41,18,"ng-template",null,1,e.W1O),e._UZ(4,"router-outlet"))},dependencies:[_.sg,_.O5,v.lC,F.BN,b._Y,b.YN,b.Kr,b.Fj,b.EJ,b.JJ,b.JL,b.Q7,b.c5,b.on,b.On,b.F,_.Ts]})}return i})();const Te=["template"],Ae=["icon"];function Ze(i,l){if(1&i&&e._UZ(0,"fa-icon",2),2&i){const t=e.oxw();e.Q6J("icon",t.faTrash)}}function Ce(i,l){if(1&i&&(e.TgZ(0,"div",8),e._UZ(1,"p",9),e.qZA()),2&i){const t=e.oxw(2);e.xp6(1),e.Q6J("innerHTML",t.erro,e.oJD)}}function Me(i,l){1&i&&e._UZ(0,"span",10)}function Ee(i,l){if(1&i){const t=e.EpF();e.TgZ(0,"div")(1,"p",3),e._uU(2,"Tem certeza que deseja excluir esse registro? Ele n\xe3o poder\xe1 ser recuperado."),e.qZA(),e.TgZ(3,"p"),e._uU(4,"O usu\xe1rio n\xe3o ter\xe1 acesso mais \xe0 plataforma."),e.qZA(),e.TgZ(5,"p",4),e._uU(6,"Obs.: Se esse usu\xe1rio estiver relacionado a um outro registro, n\xe3o poder\xe1 ser exclu\xeddo."),e.qZA(),e.YNc(7,Ce,2,1,"div",5),e.TgZ(8,"button",6),e.NdJ("click",function(){e.CHM(t);const o=e.oxw();return e.KtG(o.send())}),e.YNc(9,Me,1,0,"span",7),e.TgZ(10,"span"),e._uU(11,"Excluir"),e.qZA()()()}if(2&i){const t=e.oxw();e.xp6(7),e.Q6J("ngIf",t.erro),e.xp6(2),e.Q6J("ngIf",t.loading)}}let Se=(()=>{class i{constructor(t,s,o,a){this.activatedRoute=t,this.modalService=s,this.usuarioService=o,this.crypto=a,this.faTrash=D.$aW,this.id=0,this.erro="",this.loading=!1,this.subscription=[],this.modal=new I.u}ngAfterViewInit(){this.modal.id=0,this.modal.template=this.template,this.modal.icon=this.icon,this.modal.style={"max-width":"400px",overflow:"visible"},this.modal.activatedRoute=this.activatedRoute,this.modal.routerBackOptions={relativeTo:this.activatedRoute},this.modal.routerBack=["../../"],this.modal.title="Excluir registro";var t=this.activatedRoute.params.subscribe(s=>{if(s.usuario_id)try{this.id=this.crypto.decrypt(s.usuario_id),setTimeout(()=>{this.modal=this.modalService.addModal(this.modal,"delete usuario")},200)}catch{this.voltar()}else this.voltar()});this.subscription.push(t)}ngOnDestroy(){this.subscription.forEach(t=>t.unsubscribe())}voltar(){this.modalService.removeModal(this.modal)}send(){this.loading=!0,this.erro="",(0,x.n)(this.usuarioService.delete(this.id)).then(t=>{this.loading=!1,(0,x.n)(this.usuarioService.getList()),this.voltar()}).catch(t=>{this.loading=!1,this.erro=(0,B.b)(t)})}static#e=this.\u0275fac=function(s){return new(s||i)(e.Y36(v.gz),e.Y36(I.Z),e.Y36(g),e.Y36(d.w))};static#t=this.\u0275cmp=e.Xpm({type:i,selectors:[["app-delete"]],viewQuery:function(s,o){if(1&s&&(e.Gf(Te,5),e.Gf(Ae,5)),2&s){let a;e.iGM(a=e.CRH())&&(o.template=a.first),e.iGM(a=e.CRH())&&(o.icon=a.first)}},decls:4,vars:0,consts:[["icon",""],["template",""],[3,"icon"],[1,"mt-2"],[1,"text-info"],["class","m-0  mt-1",4,"ngIf"],[1,"btn","btn-grey","ms-auto","d-flex","mt-2",3,"click"],["class","spinner-border spinner-border-sm me-1",4,"ngIf"],[1,"m-0","mt-1"],[1,"text-danger",3,"innerHTML"],[1,"spinner-border","spinner-border-sm","me-1"]],template:function(s,o){1&s&&(e.YNc(0,Ze,1,1,"ng-template",null,0,e.W1O),e.YNc(2,Ee,12,2,"ng-template",null,1,e.W1O))},dependencies:[_.O5,F.BN]})}return i})();var Ie=n(7280),Ue=n(9336);const ye=["template"],we=["icon"];function Oe(i,l){if(1&i&&e._UZ(0,"fa-icon",2),2&i){const t=e.oxw();e.Q6J("icon",t.faKey)}}function Ye(i,l){1&i&&(e.TgZ(0,"div")(1,"p"),e._uU(2,"Tem certeza que deseja resetar sua senha?"),e.qZA(),e.TgZ(3,"p",7)(4,"small"),e._uU(5,"Voc\xea receber\xe1 um email com o link de altera\xe7\xe3o de senha."),e.qZA()(),e.TgZ(6,"p"),e._uU(7,"Ao resetar sua senha, voc\xea ser\xe1 automaticamente deslogado para realizar novo login."),e.qZA()())}function Fe(i,l){1&i&&(e.TgZ(0,"div")(1,"p"),e._uU(2,"Tem certeza que deseja resetar a senha desse usu\xe1rio? "),e.qZA(),e.TgZ(3,"p",7)(4,"small"),e._uU(5,"Esse usu\xe1rio receber\xe1 um email com o link de altera\xe7\xe3o de senha."),e.qZA()()())}function Ne(i,l){if(1&i&&(e.TgZ(0,"p",7),e._uU(1),e.qZA()),2&i){const t=e.oxw(3);e.xp6(1),e.Oqu(t.erro)}}function De(i,l){1&i&&e._UZ(0,"span",8)}function Je(i,l){if(1&i){const t=e.EpF();e.TgZ(0,"div"),e.YNc(1,Ye,8,0,"div",3),e.YNc(2,Fe,6,0,"div",3),e.YNc(3,Ne,2,1,"p",4),e.TgZ(4,"button",5),e.NdJ("click",function(){e.CHM(t);const o=e.oxw(2);return e.KtG(o.send())}),e.YNc(5,De,1,0,"span",6),e.TgZ(6,"span"),e._uU(7," Resetar"),e.qZA()()()}if(2&i){const t=e.oxw(2);e.xp6(1),e.Q6J("ngIf",(null==t.userLogado?null:t.userLogado.email)==t.objeto.email),e.xp6(1),e.Q6J("ngIf",(null==t.userLogado?null:t.userLogado.email)!=t.objeto.email),e.xp6(1),e.Q6J("ngIf",t.erro),e.xp6(2),e.Q6J("ngIf",t.loading)}}function Le(i,l){1&i&&(e.TgZ(0,"div")(1,"p",7),e._uU(2,"Voc\xea n\xe3o tem permiss\xe3o para resetar a senha de uma conta administradora."),e.qZA()())}function Qe(i,l){if(1&i&&(e.YNc(0,Je,8,4,"div",3),e.YNc(1,Le,3,0,"div",3)),2&i){const t=e.oxw();e.Q6J("ngIf",t.podeResetar),e.xp6(1),e.Q6J("ngIf",!t.podeResetar)}}let Re=(()=>{class i{constructor(t,s,o,a,u,M,N){this.activatedRoute=t,this.usuarioService=s,this.accountService=o,this.crypto=a,this.toastr=u,this.modalService=M,this.alertService=N,this.faKey=D.DD4,this.objeto=new O,this.loading=!1,this.erro="",this.subscription=[],this.modal=new I.u,this.podeResetar=!0}ngOnDestroy(){this.subscription.forEach(t=>t.unsubscribe())}ngAfterViewInit(){this.modal.id=0,this.modal.template=this.template,this.modal.icon=this.icon,this.modal.style={"max-width":"500px",overflow:"visible"},this.modal.activatedRoute=this.activatedRoute,this.modal.routerBackOptions={relativeTo:this.activatedRoute},this.modal.title="Resetar Senha",this.modal.routerBack=["../../"];var t=this.activatedRoute.params.subscribe(s=>{s.usuario_id?(this.objeto.id=this.crypto.decrypt(s.usuario_id),(0,x.n)(this.usuarioService.get(this.objeto.id)).then(o=>{this.objeto=o;var a=this.accountService.accountValue;a?.perfilAcesso_Id==h.uU.Master&&o.perfilAcesso_Id==h.uU.Admin&&(this.toastr.info("Voc\xea n\xe3o tem permiss\xe3o para resetar a senha de uma conta administradora."),this.erro="Voc\xea n\xe3o tem permiss\xe3o para resetar a senha de uma conta administradora.",this.podeResetar=!1),setTimeout(()=>{this.modal=this.modalService.addModal(this.modal,"usuario")},200)}).catch(o=>{this.voltar()})):this.voltar()});this.subscription.push(t)}voltar(){this.modalService.removeModal(this.modal)}send(){this.loading=!0,(0,x.n)(this.usuarioService.resetPassword(this.objeto.id)).then(t=>{this.voltar(),this.toastr.success("Opera\xe7\xe3o conclu\xedda com sucesso"),this.alertService.success("O usu\xe1rio deve verificar a caixa de e-mail para seguir as instru\xe7\xf5es."),this.objeto.email==this.userLogado?.email&&this.accountService.logout()}).catch().finally(()=>this.loading=!1)}static#e=this.\u0275fac=function(s){return new(s||i)(e.Y36(v.gz),e.Y36(g),e.Y36(r.B),e.Y36(d.w),e.Y36(c._W),e.Y36(I.Z),e.Y36(Ue.c))};static#t=this.\u0275cmp=e.Xpm({type:i,selectors:[["app-reset-password"]],viewQuery:function(s,o){if(1&s&&(e.Gf(ye,5),e.Gf(we,5)),2&s){let a;e.iGM(a=e.CRH())&&(o.template=a.first),e.iGM(a=e.CRH())&&(o.icon=a.first)}},decls:5,vars:0,consts:[["icon",""],["template",""],[3,"icon"],[4,"ngIf"],["class","text-danger",4,"ngIf"],[1,"btn","btn-grey","ms-auto","d-flex","mt-2",3,"click"],["class","spinner-border spinner-border-sm me-1",4,"ngIf"],[1,"text-danger"],[1,"spinner-border","spinner-border-sm","me-1"]],template:function(s,o){1&s&&(e.YNc(0,Oe,1,1,"ng-template",null,0,e.W1O),e.YNc(2,Qe,2,2,"ng-template",null,1,e.W1O),e._UZ(4,"router-outlet"))},dependencies:[_.O5,v.lC,F.BN]})}return i})();const Pe=["template"];function je(i,l){1&i&&(e.TgZ(0,"span",7),e._uU(1,"habilitar"),e.qZA())}function Be(i,l){1&i&&(e.TgZ(0,"span",7),e._uU(1,"desabilitar"),e.qZA())}function qe(i,l){1&i&&(e.TgZ(0,"p",8),e._uU(1,"Voc\xea automaticamente ser\xe1 deslogado e n\xe3o poder\xe1 acessar o Planner."),e.qZA())}function Ge(i,l){1&i&&(e.TgZ(0,"p",8),e._uU(1,"Ap\xf3s isso, o usu\xe1rio n\xe3o poder\xe1 acessar o Planner."),e.qZA())}function We(i,l){if(1&i&&(e.TgZ(0,"p",8),e._uU(1),e.qZA()),2&i){const t=e.oxw(3);e.xp6(1),e.Oqu(t.erro)}}function Ke(i,l){1&i&&e._UZ(0,"span",9)}function Ve(i,l){1&i&&(e.TgZ(0,"span"),e._uU(1,"Desabilitar"),e.qZA())}function He(i,l){1&i&&(e.TgZ(0,"span"),e._uU(1,"Habilitar"),e.qZA())}function $e(i,l){if(1&i){const t=e.EpF();e.TgZ(0,"div")(1,"p"),e._uU(2,"Tem certeza que deseja "),e.YNc(3,je,2,0,"span",3),e.YNc(4,Be,2,0,"span",3),e._uU(5," esse registro? "),e.qZA(),e.YNc(6,qe,2,0,"p",4),e.YNc(7,Ge,2,0,"p",4),e.YNc(8,We,2,1,"p",4),e.TgZ(9,"button",5),e.NdJ("click",function(){e.CHM(t);const o=e.oxw(2);return e.KtG(o.send())}),e.YNc(10,Ke,1,0,"span",6),e.YNc(11,Ve,2,0,"span",1),e.YNc(12,He,2,0,"span",1),e.qZA()()}if(2&i){const t=e.oxw(2);e.xp6(3),e.Q6J("ngIf",t.habilitar),e.xp6(1),e.Q6J("ngIf",!t.habilitar),e.xp6(2),e.Q6J("ngIf",t.isUser&&t.habilitar&&t.objeto.email==(null==t.account?null:t.account.email)),e.xp6(1),e.Q6J("ngIf",t.isUser&&t.habilitar&&t.objeto.email!=(null==t.account?null:t.account.email)),e.xp6(1),e.Q6J("ngIf",t.erro),e.xp6(2),e.Q6J("ngIf",t.loading),e.xp6(1),e.Q6J("ngIf",!t.habilitar),e.xp6(1),e.Q6J("ngIf",t.habilitar)}}function ze(i,l){if(1&i&&(e.TgZ(0,"div",10)(1,"p",8),e._uU(2),e.qZA()()),2&i){const t=e.oxw(2);e.xp6(2),e.Oqu(t.erro)}}function Xe(i,l){if(1&i&&(e.YNc(0,$e,13,8,"div",1),e.YNc(1,ze,3,1,"div",2)),2&i){const t=e.oxw();e.Q6J("ngIf",t.podeAtivar),e.xp6(1),e.Q6J("ngIf",!t.podeAtivar)}}let G=(()=>{class i{constructor(t,s,o,a,u,M){this.usuarioService=t,this.modalService=s,this.activatedRoute=o,this.crypto=a,this.accountService=u,this.toastr=M,this.objeto=new O,this.loading=!1,this.erro="",this.subscription=[],this.modal=new I.u,this.podeAtivar=!0,this.habilitar=!1,this.isUser=!1,this.account=this.accountService.accountValue}ngOnDestroy(){this.subscription.forEach(t=>t.unsubscribe())}ngAfterViewInit(){this.modal.id=0,this.modal.template=this.template,this.modal.style={"max-width":"400px",overflow:"visible"},this.modal.activatedRoute=this.activatedRoute,this.modal.routerBackOptions={relativeTo:this.activatedRoute};var t=this.activatedRoute.params.subscribe(s=>{s.usuario_id?(this.objeto.id=this.crypto.decrypt(s.usuario_id),this.isUser=this.account?.id==this.objeto.id,this.modal.routerBack=["../../"],(0,x.n)(this.usuarioService.get(this.objeto.id)).then(o=>{this.objeto=o,this.habilitar=!(null==this.objeto.dataDesativado||null==this.objeto.dataDesativado),this.objeto.ativo=!this.habilitar;var a=this.accountService.accountValue;if(this.modal.title=this.habilitar?"Habilitar Usu\xe1rio":"Desabilitar Usu\xe1rio",a?.perfilAcesso_Id==h.uU.Master&&o.perfilAcesso_Id==h.uU.Admin){this.podeAtivar=!1;var u=this.habilitar?"habilitar":"desabilitar";this.toastr.info(`Voc\xea n\xe3o tem permiss\xe3o para ${u} uma conta administradora.`),this.erro=`Voc\xea n\xe3o tem permiss\xe3o para ${u} uma conta administradora.`}setTimeout(()=>{this.modal=this.modalService.addModal(this.modal,"usuario")},200)}).catch(o=>{this.voltar()})):this.voltar()});this.subscription.push(t)}voltar(){this.modalService.removeModal(this.modal)}send(){var t=this;this.loading=!0,this.erro="",(0,x.n)(this.usuarioService.deactivated(this.objeto.id,this.habilitar)).then(function(){var s=(0,R.Z)(function*(o){t.habilitar&&t.isUser&&t.accountService.logout(),yield(0,x.n)(t.usuarioService.getList()),t.voltar()});return function(o){return s.apply(this,arguments)}}()).finally(()=>this.loading=!1)}static#e=this.\u0275fac=function(s){return new(s||i)(e.Y36(g),e.Y36(I.Z),e.Y36(v.gz),e.Y36(d.w),e.Y36(r.B),e.Y36(c._W))};static#t=this.\u0275cmp=e.Xpm({type:i,selectors:[["app-deactivated"]],viewQuery:function(s,o){if(1&s&&e.Gf(Pe,5),2&s){let a;e.iGM(a=e.CRH())&&(o.template=a.first)}},decls:3,vars:0,consts:[["template",""],[4,"ngIf"],["class","mb-2",4,"ngIf"],["class","font-weight-bold",4,"ngIf"],["class","text-danger",4,"ngIf"],[1,"btn","btn-grey","ms-auto","d-flex","mt-2",3,"click"],["class","spinner-border spinner-border-sm me-1",4,"ngIf"],[1,"font-weight-bold"],[1,"text-danger"],[1,"spinner-border","spinner-border-sm","me-1"],[1,"mb-2"]],template:function(s,o){1&s&&(e.YNc(0,Xe,2,2,"ng-template",null,0,e.W1O),e._UZ(2,"router-outlet"))},dependencies:[_.O5,v.lC]})}return i})();var ke=n(9742);const et=[{path:"",component:X,children:[{path:"cadastrar",component:q,data:{modalOrder:1},title:"Zentech - Cadastrar usu\xe1rio"},{path:"editar/:usuario_id",component:q,data:{modalOrder:1},title:"Zentech - Editar usu\xe1rio",canActivate:[A]},{path:"excluir/:usuario_id",component:Se,data:{modalOrder:1,roles:[h.uU.Admin]},title:"Zentech - Excluir usu\xe1rio",canActivate:[A,ke.p]},{path:"reset-password/:usuario_id",component:Re,data:{modalOrder:1},title:"Zentech - Resetar senha",canActivate:[A]},{path:"habilitar/:usuario_id",component:G,data:{modalOrder:1},title:"Zentech - Habilitar usu\xe1rio",canActivate:[A]},{path:"desabilitar/:usuario_id",component:G,data:{modalOrder:1},title:"Zentech - Desabilitar usu\xe1rio",canActivate:[A]},Ie.D]}];let tt=(()=>{class i{static#e=this.\u0275fac=function(s){return new(s||i)};static#t=this.\u0275mod=e.oAB({type:i});static#i=this.\u0275inj=e.cJS({imports:[v.Bz.forChild(et),v.Bz]})}return i})();var it=n(9227);let st=(()=>{class i{static#e=this.\u0275fac=function(s){return new(s||i)};static#t=this.\u0275mod=e.oAB({type:i});static#i=this.\u0275inj=e.cJS({imports:[_.ez,tt,it.m,F.uH,b.u5]})}return i})()},9901:(P,y,n)=>{n.d(y,{j:()=>Q});var _=n(5861),Y=n(708),h=n(490),e=n(5038),r=n(9291),Z=n(6434),w=n(6814),T=n(6223),C=n(5219),p=n(2352);function S(m,U){if(1&m&&(r.TgZ(0,"span"),r._uU(1),r.qZA()),2&m){const c=r.oxw(3);r.xp6(1),r.Oqu(null==c.empresaSelected.empresa?null:c.empresaSelected.empresa.nome)}}function O(m,U){if(1&m&&r.YNc(0,S,2,1,"span",7),2&m){const c=r.oxw(2);r.Q6J("ngIf",c.empresaSelected.id)}}function j(m,U){if(1&m&&(r.TgZ(0,"p"),r._uU(1),r.qZA(),r.TgZ(2,"p"),r._uU(3),r.qZA()),2&m){const c=U.$implicit;r.xp6(1),r.Oqu(c.nome),r.xp6(2),r.Oqu(c.logo)}}function L(m,U){if(1&m){const c=r.EpF();r.TgZ(0,"div",1)(1,"label",2),r._uU(2,"Selecione a Empresa para carregar dados"),r.qZA(),r.TgZ(3,"p-dropdown",3,4),r.NdJ("ngModelChange",function(f){r.CHM(c);const g=r.oxw();return r.KtG(g.empresaChange(f))})("ngModelChange",function(f){r.CHM(c);const g=r.oxw();return r.KtG(g.empresaSelected.id=f)}),r.YNc(5,O,1,1,"ng-template",5),r.YNc(6,j,4,2,"ng-template",6),r.qZA()()}if(2&m){const c=r.oxw();r.xp6(3),r.Q6J("options",c.empresas)("ngModel",c.empresaSelected.id)("filter",!0)("showClear",!1)("required",!0)}}let Q=(()=>{class m{constructor(c,d){this.empresaService=c,this.accountService=d,this.empresaSelected=new e.I,this.empresas=[],this.loading=!1,this.Role=h.uU,this.subscription=[];var f=this.accountService.account.subscribe(A=>this.account=A);this.subscription.push(f);var g=this.empresaService.empresaSelected.subscribe(A=>this.empresaSelected=A);this.subscription.push(g);var v=this.empresaService.list.subscribe(A=>this.empresas=A);this.subscription.push(v)}ngOnDestroy(){this.subscription.forEach(c=>c.unsubscribe())}empresaChange(c){var d=this;return(0,_.Z)(function*(){if(d.accountService.accountValue&&1==d.accountService.accountValue?.perfilAcesso_Id&&c){0==d.empresas.length&&(yield(0,Y.n)(d.empresaService.getList()));var f=d.empresas.find(g=>g.id==c);d.empresaService.empresaSelected.next({empresa:f,id:c})}})()}static#e=this.\u0275fac=function(d){return new(d||m)(r.Y36(e.P),r.Y36(Z.B))};static#t=this.\u0275cmp=r.Xpm({type:m,selectors:[["app-empresa-selected"]],decls:1,vars:1,consts:[["class","form-group ms-2",4,"ngIf"],[1,"form-group","ms-2"],["for","empresa_Id"],["name","empresa_Id","id","empresa_Id","optionValue","id","filterBy","nome","styleClass","form-control","placeholder","Selecione uma empresa",3,"options","ngModel","filter","showClear","required","ngModelChange"],["empresa_Id","ngModel"],["pTemplate","selectedItem"],["pTemplate","item"],[4,"ngIf"]],template:function(d,f){1&d&&r.YNc(0,L,7,5,"div",0),2&d&&r.Q6J("ngIf",f.account&&1==(null==f.account?null:f.account.perfilAcesso_Id))},dependencies:[w.O5,T.JJ,T.Q7,T.On,C.jx,p.Lt]})}return m})()}}]);