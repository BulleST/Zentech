"use strict";(self.webpackChunkZenTech=self.webpackChunkZenTech||[]).push([[901],{2901:(G,O,l)=>{l.r(O),l.d(O,{UsuariosModule:()=>st});var T=l(6814),J=l(5592),v=l(490),e=l(9291),n=l(6434),Y=l(9862),S=l(5619),I=l(9397),D=l(2096),d=l(2832),C=l(5219);class U{constructor(){this.id=0,this.perfilAcesso=void 0,this.perfilAcesso_Id=void 0,this.name="",this.email="",this.telefoneCelular="",this.empresa_Id=0}}var Q=[{field:"id",header:"Id",maskType:d.O.undefined,filterType:d.vA.text,filterDisplay:d.w2.menu,showAddButton:!1,showMatchMode:!1,showOperator:!1,filterMatchMode:C.a6.EQUALS},{field:"name",header:"Nome",filterType:d.vA.text,filterDisplay:d.w2.menu,maskType:d.O.substring,substringLength:22,showAddButton:!1,showMatchMode:!1,showOperator:!1,filterMatchMode:C.a6.CONTAINS},{field:"email",header:"E-mail",filterType:d.vA.text,filterDisplay:d.w2.menu,maskType:d.O.substring,substringLength:30,showAddButton:!1,showMatchMode:!1,showOperator:!1,filterMatchMode:C.a6.CONTAINS},{field:"telefoneCelular",header:"Telefone/Celular",filterType:d.vA.text,filterDisplay:d.w2.menu,maskType:d.O.undefined,showAddButton:!1,showMatchMode:!1,showOperator:!1,filterMatchMode:C.a6.CONTAINS},{field:"perfilAcesso.perfil",header:"Tipo de Acesso",maskType:d.O.options,filterType:d.vA.text,filterDisplay:d.w2.menu,showAddButton:!1,showMatchMode:!1,showOperator:!1,filterMatchMode:C.a6.EQUALS,values:[{value:"Admin",output:"Admin",class:"flag-yellow"},{value:"Master",output:"Master",class:"flag-info"}]},{field:"ativo",header:"Ativo",maskType:d.O.options,filterType:d.vA.text,filterDisplay:d.w2.menu,showAddButton:!1,showMatchMode:!1,showOperator:!1,filterMatchMode:C.a6.EQUALS,values:[{value:!0,output:"Ativo",class:"flag-green"},{value:!1,output:"Inativo",class:"flag-danger"}]}],L=l(553),m=l(697),E=l(8787),c=l(2425),u=l(2667),_=l(5038);let h=(()=>{class i{constructor(t,s,o,a,p,A){this.table=t,this.http=s,this.toastr=o,this.crypto=a,this.accountService=p,this.empresaService=A,this.url=L.N.url,this.list=new S.X([]),this.objeto=new S.X(void 0),this.account=new m.mR,this.perfilAcesso=new S.X([]),this.loading=new S.X(!1),this.accountService.account.subscribe(w=>this.account=w??new m.mR)}getObject(){var t=localStorage.getItem("usuario");return t&&this.setObject(this.crypto.decrypt(t)??new U),this.objeto}setObject(t){localStorage.setItem("usuario",this.crypto.encrypt(t)??""),this.objeto.next(t)}getList(t=!1){return this.loading.next(t),this.table.loading.next(!0),this.http.get(`${this.url}/usuario/list/${this.empresaService.empresaSelected.value.id}`).pipe((0,I.b)({next:o=>(o=o.map(a=>(a.ativo=!a.dataDesativado,a)),this.list.next(o),this.loading.next(!1),(0,D.of)(o)),error:o=>this.toastr.error("N\xe3o foi poss\xedvel carregar usu\xe1rios."),finalize:()=>this.loading.next(!1)}))}get(t){return this.http.get(`${this.url}/usuario/${t}`,{headers:new Y.WM({loading:"true"})})}getPerfilAcesso(){return this.http.get(`${this.url}/perfilAcesso/getAll`).pipe((0,I.b)({next:t=>(this.perfilAcesso.next(t),t),error:t=>this.toastr.error("N\xe3o foi poss\xedvel carregar perfil.")}))}create(t){return t.empresa_Id=this.empresaService.empresaSelected.value.id,this.http.post(`${this.url}/usuario`,t)}edit(t){return t.empresa_Id=this.empresaService.empresaSelected.value.id,this.http.put(`${this.url}/usuario`,t)}delete(t){return this.http.delete(`${this.url}/usuario/${t}`)}deactivated(t,s){return this.http.patch(`${this.url}/usuario/${t}/${s}`,{})}resetPassword(t){return this.http.patch(`${this.url}/usuario/reset-password/${t}`,{})}static#e=this.\u0275fac=function(s){return new(s||i)(e.LFG(E.i),e.LFG(Y.eN),e.LFG(c._W),e.LFG(u.w),e.LFG(n.B),e.LFG(_.P))};static#t=this.\u0275prov=e.Yz7({token:i,factory:i.\u0275fac,providedIn:"root"})}return i})();var f=l(132);let x=(()=>{class i{constructor(t,s,o,a){this.accountService=t,this.userService=s,this.router=o,this.toastr=a}canActivate(t,s){return new J.y(o=>{this.userService.objeto.subscribe(a=>{var p=this.accountService.accountValue;o.next(p?.perfilAcesso_Id!=v.uU.Master||a?.perfilAcesso_Id!=v.uU.Admin)})})}static#e=this.\u0275fac=function(s){return new(s||i)(e.LFG(n.B),e.LFG(h),e.LFG(f.F0),e.LFG(c._W))};static#t=this.\u0275prov=e.Yz7({token:i,factory:i.\u0275fac,providedIn:"root"})}return i})();var R=l(5861),N=l(590),g=l(708),H=l(6599),V=l(9901),y=l(5597);function W(i,r){if(1&i&&(e.TgZ(0,"p",13)(1,"small"),e._uU(2,"Usu\xe1rios cadastrados em "),e.TgZ(3,"strong"),e._uU(4),e.qZA()()()),2&i){const t=e.oxw();e.xp6(4),e.Oqu(t.empresaSelected.nome||"Empresa X")}}function K(i,r){1&i&&e._UZ(0,"span",14)}const $=function(){return["cadastrar"]};function z(i,r){1&i&&(e.TgZ(0,"div",15)(1,"a",16)(2,"span",17),e._uU(3," Cadastrar Usu\xe1rio"),e.qZA()()()),2&i&&(e.xp6(1),e.Q6J("routerLink",e.DdM(1,$)))}let X=(()=>{class i{constructor(t,s,o,a){var p=this;this.table=t,this.userService=s,this.accountService=o,this.empresaService=a,this.faUsers=N.FVb,this.list=[],this.tableLinks=[],this.columns=Q,this.subscription=[],this.loading=!1;var A=this.userService.list.subscribe(Z=>this.list=Object.assign([],Z));this.subscription.push(A);var w=this.userService.loading.subscribe(Z=>this.loading=Z);this.subscription.push(w);var ot=this.empresaService.empresaSelected.subscribe(function(){var Z=(0,R.Z)(function*(F){p.empresaSelected=F.empresa,F&&F.id&&(yield(0,g.n)(p.userService.getList(!0)))});return function(F){return Z.apply(this,arguments)}}());this.subscription.push(ot),(0,g.n)(this.userService.getList(!0));var at=this.table.selected.subscribe(Z=>{Z&&(this.tableLinks=[{label:"Editar",routePath:["editar"],paramsFieldName:["id"]},{label:Z.ativo?"Desabilitar":"Habilitar",routePath:[Z.ativo?"desabilitar":"habilitar"],paramsFieldName:["id"]},{label:"Resetar senha",routePath:["reset-password"],paramsFieldName:["id"]}],1==this.accountService.accountValue?.perfilAcesso_Id&&this.tableLinks.push({label:"Excluir",routePath:["excluir"],paramsFieldName:["id"]}),this.tableLinks=this.table.encryptParams(this.tableLinks))});this.subscription.push(at)}ngOnDestroy(){this.subscription.forEach(t=>t.unsubscribe())}getList(){(0,g.n)(this.userService.getList(!0))}static#e=this.\u0275fac=function(s){return new(s||i)(e.Y36(E.i),e.Y36(h),e.Y36(n.B),e.Y36(_.P))};static#t=this.\u0275cmp=e.Xpm({type:i,selectors:[["app-list"]],decls:18,vars:14,consts:[[1,"page"],[1,"page__header"],[1,"title-icon","align-items-center"],[3,"icon"],[1,"me-auto"],[1,"page__header-title"],["class","page__header-subtitle",4,"ngIf"],[1,"ms-auto","mt-auto",2,"margin-bottom","7px"],[1,"btn","btn-dark",3,"disabled","click"],["class","spinner-border spinner-border-sm me-1",4,"ngIf"],[1,"page__body"],["topActions",""],[3,"list","topActions","filterLink","filterTable","paginator","sortTable","menuTable","columns","tableLinks","selectable"],[1,"page__header-subtitle"],[1,"spinner-border","spinner-border-sm","me-1"],[1,"col-xl-4","col-lg-4","col-md-4","col-sm-6","col-12","mb-2","me-md-2","mx-md-1","px-0","ng-star-inserted"],[1,"btn","btn-primary","d-flex","align-items-center","align-baseline","justify-content-center","me-md-0","me-sm-1",3,"routerLink"],[2,"margin-top","-1px","margin-bottom","1px"]],template:function(s,o){if(1&s&&(e.TgZ(0,"section",0)(1,"div",1)(2,"span",2),e._UZ(3,"fa-icon",3),e.qZA(),e.TgZ(4,"div",4)(5,"h3",5),e._uU(6,"Usu\xe1rios"),e.qZA(),e.YNc(7,W,5,1,"p",6),e.qZA(),e.TgZ(8,"div",7)(9,"button",8),e.NdJ("click",function(){return o.getList()}),e.YNc(10,K,1,0,"span",9),e._uU(11,"Atualizar"),e.qZA()(),e._UZ(12,"app-empresa-selected"),e.qZA(),e.TgZ(13,"div",10),e.YNc(14,z,4,2,"ng-template",null,11,e.W1O),e._UZ(16,"app-list-shared",12),e.qZA()(),e._UZ(17,"router-outlet")),2&s){const a=e.MAs(15);e.xp6(3),e.Q6J("icon",o.faUsers),e.xp6(4),e.Q6J("ngIf",o.empresaSelected),e.xp6(2),e.Q6J("disabled",o.loading),e.xp6(1),e.Q6J("ngIf",o.loading),e.xp6(6),e.Q6J("list",o.list)("topActions",a)("filterLink",!1)("filterTable",!0)("paginator",!0)("sortTable",!0)("menuTable",!0)("columns",o.columns)("tableLinks",o.tableLinks)("selectable",!0)}},dependencies:[T.O5,f.lC,f.rH,H.o,V.j,y.BN]})}return i})();var M=l(2855),P=l(342),b=l(6223);const k=["template"],ee=["icon"];function te(i,r){if(1&i&&e._UZ(0,"fa-icon",2),2&i){const t=e.oxw();e.Q6J("icon",t.faUser)}}function ie(i,r){1&i&&(e.TgZ(0,"p",9),e._uU(1,"Este campo \xe9 obrigat\xf3rio."),e.qZA())}function se(i,r){1&i&&(e.TgZ(0,"span"),e._uU(1,"Remova os espa\xe7os antes e depois do texto."),e.qZA())}function oe(i,r){if(1&i&&(e.TgZ(0,"p",9),e.YNc(1,se,2,0,"span",12),e.qZA()),2&i){e.oxw(2);const t=e.MAs(10);e.xp6(1),e.Q6J("ngIf","^\\S(.*\\S)?$"==t.errors.pattern.requiredPattern)}}function ae(i,r){if(1&i&&(e.TgZ(0,"div"),e.YNc(1,ie,2,0,"p",26),e.YNc(2,oe,2,1,"p",26),e.qZA()),2&i){e.oxw();const t=e.MAs(10);e.xp6(1),e.Q6J("ngIf",t.errors.required),e.xp6(1),e.Q6J("ngIf",t.errors.pattern)}}function ne(i,r){1&i&&(e.TgZ(0,"p",9),e._uU(1,"Este campo \xe9 obrigat\xf3rio."),e.qZA())}function re(i,r){1&i&&(e.TgZ(0,"p",9),e._uU(1,"Telefone/celular inv\xe1lido"),e.qZA())}function le(i,r){if(1&i&&(e.TgZ(0,"div"),e.YNc(1,ne,2,0,"p",26),e.YNc(2,re,2,0,"p",26),e.qZA()),2&i){e.oxw();const t=e.MAs(18);e.xp6(1),e.Q6J("ngIf",t.errors.required),e.xp6(1),e.Q6J("ngIf",t.errors.mask)}}function ce(i,r){if(1&i&&(e.TgZ(0,"option",19),e._uU(1),e.qZA()),2&i){const t=r.$implicit;e.Q6J("ngValue",t.id),e.xp6(1),e.Oqu(t.perfil)}}function pe(i,r){1&i&&(e.TgZ(0,"p",9),e._uU(1,"Este campo \xe9 obrigat\xf3rio."),e.qZA())}function ue(i,r){if(1&i&&(e.TgZ(0,"div"),e.YNc(1,pe,2,0,"p",26),e.qZA()),2&i){e.oxw();const t=e.MAs(26);e.xp6(1),e.Q6J("ngIf",t.errors.required)}}function de(i,r){1&i&&(e.TgZ(0,"p",9),e._uU(1,"Este campo \xe9 obrigat\xf3rio."),e.qZA())}function me(i,r){1&i&&(e.TgZ(0,"p",9),e._uU(1,"E-mail inv\xe1lido"),e.qZA())}function _e(i,r){if(1&i&&(e.TgZ(0,"div"),e.YNc(1,de,2,0,"p",26),e.YNc(2,me,2,0,"p",26),e.qZA()),2&i){e.oxw();const t=e.MAs(37);e.xp6(1),e.Q6J("ngIf",t.errors.required),e.xp6(1),e.Q6J("ngIf",t.errors.email)}}function he(i,r){if(1&i&&(e.TgZ(0,"p",9),e._uU(1),e.ALo(2,"json"),e.qZA()),2&i){const t=r.$implicit;e.xp6(1),e.Oqu(e.lcZ(2,1,t))}}function fe(i,r){1&i&&(e.TgZ(0,"p",9),e._uU(1,"Preencha todos os campos obrigat\xf3rios (*) corretamente para salvar"),e.qZA())}function ge(i,r){if(1&i&&(e.TgZ(0,"div",31),e.YNc(1,he,3,3,"p",32),e.YNc(2,fe,2,0,"p",26),e.qZA()),2&i){e.oxw(2);const t=e.MAs(1),s=e.oxw();e.xp6(1),e.Q6J("ngForOf",s.erro),e.xp6(1),e.Q6J("ngIf",t.invalid&&0==s.erro.length)}}function ve(i,r){1&i&&e._UZ(0,"span",33)}function xe(i,r){if(1&i&&(e.TgZ(0,"div",27),e.YNc(1,ge,3,2,"div",28),e.TgZ(2,"button",29),e.YNc(3,ve,1,0,"span",30),e.TgZ(4,"span"),e._uU(5,"Salvar"),e.qZA()()()),2&i){e.oxw();const t=e.MAs(1),s=e.oxw();e.xp6(1),e.Q6J("ngIf",s.erro||t.invalid),e.xp6(1),e.Q6J("disabled",t.invalid||s.loading||!s.podeEditar),e.xp6(1),e.Q6J("ngIf",s.loading)}}function be(i,r){if(1&i){const t=e.EpF();e.TgZ(0,"form",3,4),e.NdJ("ngSubmit",function(){e.CHM(t);const o=e.MAs(1),a=e.oxw();return e.KtG(a.send(o))}),e.TgZ(2,"div",5)(3,"div",6)(4,"div",7)(5,"label",8),e._uU(6,"Nome: "),e.TgZ(7,"span",9),e._uU(8,"*"),e.qZA()(),e.TgZ(9,"input",10,11),e.NdJ("ngModelChange",function(o){e.CHM(t);const a=e.oxw();return e.KtG(a.objeto.name=o)})("change",function(){e.CHM(t);const o=e.MAs(10),a=e.oxw();return e.KtG(a.objeto.name=o.value.trim())}),e.qZA(),e.YNc(11,ae,3,2,"div",12),e.qZA(),e.TgZ(12,"div",7)(13,"label",13),e._uU(14,"Telefone/Celular: "),e.TgZ(15,"span",9),e._uU(16,"*"),e.qZA()(),e.TgZ(17,"input",14,15),e.NdJ("ngModelChange",function(o){e.CHM(t);const a=e.oxw();return e.KtG(a.objeto.telefoneCelular=o)}),e.qZA(),e.YNc(19,le,3,2,"div",12),e.qZA(),e.TgZ(20,"div",7)(21,"label",16),e._uU(22,"Perfil: "),e.TgZ(23,"span",9),e._uU(24,"*"),e.qZA()(),e.TgZ(25,"select",17,18),e.NdJ("ngModelChange",function(o){e.CHM(t);const a=e.oxw();return e.KtG(a.objeto.perfilAcesso_Id=o)}),e.TgZ(27,"option",19),e._uU(28,"Selecione"),e.qZA(),e.YNc(29,ce,2,2,"option",20),e.qZA(),e.YNc(30,ue,2,1,"div",12),e.qZA(),e.TgZ(31,"div",21)(32,"label",22),e._uU(33,"E-mail: "),e.TgZ(34,"span",9),e._uU(35,"*"),e.qZA()(),e.TgZ(36,"input",23,24),e.NdJ("ngModelChange",function(o){e.CHM(t);const a=e.oxw();return e.KtG(a.objeto.email=o)}),e.qZA(),e.YNc(38,_e,3,2,"div",12),e.qZA()(),e.TgZ(39,"div",6),e.YNc(40,xe,6,3,"div",25),e.qZA()()()}if(2&i){const t=e.MAs(10),s=e.MAs(18),o=e.MAs(26),a=e.MAs(37),p=e.oxw();e.xp6(9),e.Q6J("ngModel",p.objeto.name)("disabled",!p.podeEditar),e.xp6(2),e.Q6J("ngIf",t.touched&&t.errors),e.xp6(6),e.Q6J("ngModel",p.objeto.telefoneCelular)("disabled",!p.podeEditar),e.xp6(2),e.Q6J("ngIf",s.touched&&s.errors),e.xp6(6),e.Q6J("ngModel",p.objeto.perfilAcesso_Id)("disabled",!p.podeEditar),e.xp6(2),e.Q6J("ngValue",void 0),e.xp6(2),e.Q6J("ngForOf",p.perfil),e.xp6(1),e.Q6J("ngIf",o.touched&&o.errors),e.xp6(6),e.Q6J("email",!0)("ngModel",p.objeto.email)("readonly",p.isEditPage)("pattern",p.emailPattern)("disabled",!p.podeEditar),e.xp6(2),e.Q6J("ngIf",a.touched&&a.errors),e.xp6(2),e.Q6J("ngIf",p.podeEditar)}}let q=(()=>{class i{constructor(t,s,o,a,p,A){this.usuarioService=t,this.modalService=s,this.activatedRoute=o,this.crypto=a,this.accountService=p,this.toastr=A,this.faUser=N.ILF,this.objeto=new U,this.loading=!1,this.erro="",this.isEditPage=!1,this.perfil=[],this.subscription=[],this.emailPattern=/^(([^<>()[\]\.,;:\s@\"]+(\.[^<>()[\]\.,;:\s@\"]+)*)|(\".+\"))@(([^<>()[\]\.,;:\s@\"]+\.)+[^<>()[\]\.,;:\s@\"]{2,})$/i,this.modal=new M.u,this.podeEditar=!0,this.perfil=v.JH,this.account=this.accountService.accountValue,this.perfil=this.account?.perfilAcesso_Id==v.uU.Master?[{id:2,perfil:"Master"}]:[{id:1,perfil:"Admin"},{id:2,perfil:"Master"}]}ngOnDestroy(){this.subscription.forEach(t=>t.unsubscribe())}ngAfterViewInit(){this.modal.id=0,this.modal.template=this.template,this.modal.icon=this.icon,this.modal.style={"max-width":"900px",overflow:"visible"},this.modal.activatedRoute=this.activatedRoute,this.modal.routerBackOptions={relativeTo:this.activatedRoute};var t=this.activatedRoute.params.subscribe(s=>{s.usuario_id?(this.objeto.id=this.crypto.decrypt(s.usuario_id),this.modal.title="Editar Usu\xe1rio",this.modal.routerBack=["../../"],this.isEditPage=!0,(0,g.n)(this.usuarioService.get(this.objeto.id)).then(o=>{this.objeto=o,this.account?.perfilAcesso_Id==v.uU.Master&&o.perfilAcesso_Id==v.uU.Admin&&(this.podeEditar=!1,this.toastr.info("Voc\xea n\xe3o tem permiss\xe3o para editar uma conta administradora.")),setTimeout(()=>{this.modal=this.modalService.addModal(this.modal,"usuario")},200)}).catch(o=>{this.voltar()})):(this.modal.title="Cadastrar Usu\xe1rio",this.modal.routerBack=["../"],this.isEditPage=!1,setTimeout(()=>{this.modal=this.modalService.addModal(this.modal,"usuario")},200))});this.subscription.push(t)}voltar(){this.modalService.removeModal(this.modal)}send(t){var s=this;this.loading=!0,this.erro="",this.request().then(function(){var o=(0,R.Z)(function*(a){yield(0,g.n)(s.usuarioService.getList()),s.voltar()});return function(a){return o.apply(this,arguments)}}()).catch(o=>{this.erro=(0,P.b)(o)}).finally(()=>this.loading=!1),console.log(this.objeto)}request(){return(0,g.n)(0==this.objeto.id?this.usuarioService.create(this.objeto):this.usuarioService.edit(this.objeto))}static#e=this.\u0275fac=function(s){return new(s||i)(e.Y36(h),e.Y36(M.Z),e.Y36(f.gz),e.Y36(u.w),e.Y36(n.B),e.Y36(c._W))};static#t=this.\u0275cmp=e.Xpm({type:i,selectors:[["app-form"]],viewQuery:function(s,o){if(1&s&&(e.Gf(k,5),e.Gf(ee,5)),2&s){let a;e.iGM(a=e.CRH())&&(o.template=a.first),e.iGM(a=e.CRH())&&(o.icon=a.first)}},decls:5,vars:0,consts:[["icon",""],["template",""],[3,"icon"],[3,"ngSubmit"],["form","ngForm"],[1,"px-2"],[1,"row"],[1,"form-group","col-xl-4","col-lg-4","col-md-6","col-sm-6","col-12"],["for","name"],[1,"text-danger"],["type","text","name","name","id","name","required","","pattern","\\S(.*\\S)?",1,"form-control",3,"ngModel","disabled","ngModelChange","change"],["name","ngModel"],[4,"ngIf"],["for","telefoneCelular"],["type","text","name","telefoneCelular","id","telefoneCelular","required","",1,"form-control",3,"ngModel","disabled","ngModelChange"],["telefoneCelular","ngModel"],["for","perfilAcesso_Id"],["name","perfilAcesso_Id","id","perfilAcesso_Id","required","",1,"form-control",3,"ngModel","disabled","ngModelChange"],["perfilAcesso_Id","ngModel"],[3,"ngValue"],[3,"ngValue",4,"ngFor","ngForOf"],[1,"form-group","col-xl-12","col-lg-12","col-md-6","col-sm-6","col-12","email-container"],["for","email"],["type","email","name","email","id","email","placeholder","example@hotmail.com","required","",1,"form-control",3,"email","ngModel","readonly","pattern","disabled","ngModelChange"],["email","ngModel"],["class","d-flex align-items-start flex-wrap mt-2 mb-1",4,"ngIf"],["class","text-danger",4,"ngIf"],[1,"d-flex","align-items-start","flex-wrap","mt-2","mb-1"],["class","m-0",4,"ngIf"],[1,"btn","btn-primary","me-0","ms-auto",3,"disabled"],["class","spinner-border spinner-border-sm me-1",4,"ngIf"],[1,"m-0"],["class","text-danger",4,"ngFor","ngForOf"],[1,"spinner-border","spinner-border-sm","me-1"]],template:function(s,o){1&s&&(e.YNc(0,te,1,1,"ng-template",null,0,e.W1O),e.YNc(2,be,41,18,"ng-template",null,1,e.W1O),e._UZ(4,"router-outlet"))},dependencies:[T.sg,T.O5,f.lC,y.BN,b._Y,b.YN,b.Kr,b.Fj,b.EJ,b.JJ,b.JL,b.Q7,b.c5,b.on,b.On,b.F,T.Ts]})}return i})();const Te=["template"],Ae=["icon"];function Ze(i,r){if(1&i&&e._UZ(0,"fa-icon",2),2&i){const t=e.oxw();e.Q6J("icon",t.faTrash)}}function Ce(i,r){if(1&i&&(e.TgZ(0,"div",8),e._UZ(1,"p",9),e.qZA()),2&i){const t=e.oxw(2);e.xp6(1),e.Q6J("innerHTML",t.erro,e.oJD)}}function Me(i,r){1&i&&e._UZ(0,"span",10)}function Ee(i,r){if(1&i){const t=e.EpF();e.TgZ(0,"div")(1,"p",3),e._uU(2,"Tem certeza que deseja excluir esse registro? Ele n\xe3o poder\xe1 ser recuperado."),e.qZA(),e.TgZ(3,"p"),e._uU(4,"O usu\xe1rio n\xe3o ter\xe1 acesso mais \xe0 plataforma."),e.qZA(),e.TgZ(5,"p",4),e._uU(6,"Obs.: Se esse usu\xe1rio estiver relacionado a um outro registro, n\xe3o poder\xe1 ser exclu\xeddo."),e.qZA(),e.YNc(7,Ce,2,1,"div",5),e.TgZ(8,"button",6),e.NdJ("click",function(){e.CHM(t);const o=e.oxw();return e.KtG(o.send())}),e.YNc(9,Me,1,0,"span",7),e.TgZ(10,"span"),e._uU(11,"Excluir"),e.qZA()()()}if(2&i){const t=e.oxw();e.xp6(7),e.Q6J("ngIf",t.erro),e.xp6(2),e.Q6J("ngIf",t.loading)}}let Se=(()=>{class i{constructor(t,s,o,a){this.activatedRoute=t,this.modalService=s,this.usuarioService=o,this.crypto=a,this.faTrash=N.$aW,this.id=0,this.erro="",this.loading=!1,this.subscription=[],this.modal=new M.u}ngAfterViewInit(){this.modal.id=0,this.modal.template=this.template,this.modal.icon=this.icon,this.modal.style={"max-width":"400px",overflow:"visible"},this.modal.activatedRoute=this.activatedRoute,this.modal.routerBackOptions={relativeTo:this.activatedRoute},this.modal.routerBack=["../../"],this.modal.title="Excluir registro";var t=this.activatedRoute.params.subscribe(s=>{if(s.usuario_id)try{this.id=this.crypto.decrypt(s.usuario_id),setTimeout(()=>{this.modal=this.modalService.addModal(this.modal,"delete usuario")},200)}catch{this.voltar()}else this.voltar()});this.subscription.push(t)}ngOnDestroy(){this.subscription.forEach(t=>t.unsubscribe())}voltar(){this.modalService.removeModal(this.modal)}send(){this.loading=!0,this.erro="",(0,g.n)(this.usuarioService.delete(this.id)).then(t=>{this.loading=!1,(0,g.n)(this.usuarioService.getList()),this.voltar()}).catch(t=>{this.loading=!1,this.erro=(0,P.b)(t)})}static#e=this.\u0275fac=function(s){return new(s||i)(e.Y36(f.gz),e.Y36(M.Z),e.Y36(h),e.Y36(u.w))};static#t=this.\u0275cmp=e.Xpm({type:i,selectors:[["app-delete"]],viewQuery:function(s,o){if(1&s&&(e.Gf(Te,5),e.Gf(Ae,5)),2&s){let a;e.iGM(a=e.CRH())&&(o.template=a.first),e.iGM(a=e.CRH())&&(o.icon=a.first)}},decls:4,vars:0,consts:[["icon",""],["template",""],[3,"icon"],[1,"mt-2"],[1,"text-info"],["class","m-0  mt-1",4,"ngIf"],[1,"btn","btn-grey","ms-auto","d-flex","mt-2",3,"click"],["class","spinner-border spinner-border-sm me-1",4,"ngIf"],[1,"m-0","mt-1"],[1,"text-danger",3,"innerHTML"],[1,"spinner-border","spinner-border-sm","me-1"]],template:function(s,o){1&s&&(e.YNc(0,Ze,1,1,"ng-template",null,0,e.W1O),e.YNc(2,Ee,12,2,"ng-template",null,1,e.W1O))},dependencies:[T.O5,y.BN]})}return i})();var Ie=l(7280),Ue=l(9336);const ye=["template"],we=["icon"];function Oe(i,r){if(1&i&&e._UZ(0,"fa-icon",2),2&i){const t=e.oxw();e.Q6J("icon",t.faKey)}}function Ye(i,r){1&i&&(e.TgZ(0,"div")(1,"p"),e._uU(2,"Tem certeza que deseja resetar sua senha?"),e.qZA(),e.TgZ(3,"p",7)(4,"small"),e._uU(5,"Voc\xea receber\xe1 um email com o link de altera\xe7\xe3o de senha."),e.qZA()(),e.TgZ(6,"p"),e._uU(7,"Ao resetar sua senha, voc\xea ser\xe1 automaticamente deslogado para realizar novo login."),e.qZA()())}function Ne(i,r){1&i&&(e.TgZ(0,"div")(1,"p"),e._uU(2,"Tem certeza que deseja resetar a senha desse usu\xe1rio? "),e.qZA(),e.TgZ(3,"p",7)(4,"small"),e._uU(5,"Esse usu\xe1rio receber\xe1 um email com o link de altera\xe7\xe3o de senha."),e.qZA()()())}function Fe(i,r){if(1&i&&(e.TgZ(0,"p",7),e._uU(1),e.qZA()),2&i){const t=e.oxw(3);e.xp6(1),e.Oqu(t.erro)}}function Je(i,r){1&i&&e._UZ(0,"span",8)}function De(i,r){if(1&i){const t=e.EpF();e.TgZ(0,"div"),e.YNc(1,Ye,8,0,"div",3),e.YNc(2,Ne,6,0,"div",3),e.YNc(3,Fe,2,1,"p",4),e.TgZ(4,"button",5),e.NdJ("click",function(){e.CHM(t);const o=e.oxw(2);return e.KtG(o.send())}),e.YNc(5,Je,1,0,"span",6),e.TgZ(6,"span"),e._uU(7," Resetar"),e.qZA()()()}if(2&i){const t=e.oxw(2);e.xp6(1),e.Q6J("ngIf",(null==t.userLogado?null:t.userLogado.email)==t.objeto.email),e.xp6(1),e.Q6J("ngIf",(null==t.userLogado?null:t.userLogado.email)!=t.objeto.email),e.xp6(1),e.Q6J("ngIf",t.erro),e.xp6(2),e.Q6J("ngIf",t.loading)}}function Qe(i,r){1&i&&(e.TgZ(0,"div")(1,"p",7),e._uU(2,"Voc\xea n\xe3o tem permiss\xe3o para resetar a senha de uma conta administradora."),e.qZA()())}function Le(i,r){if(1&i&&(e.YNc(0,De,8,4,"div",3),e.YNc(1,Qe,3,0,"div",3)),2&i){const t=e.oxw();e.Q6J("ngIf",t.podeResetar),e.xp6(1),e.Q6J("ngIf",!t.podeResetar)}}let Re=(()=>{class i{constructor(t,s,o,a,p,A,w){this.activatedRoute=t,this.usuarioService=s,this.accountService=o,this.crypto=a,this.toastr=p,this.modalService=A,this.alertService=w,this.faKey=N.DD4,this.objeto=new U,this.loading=!1,this.erro="",this.subscription=[],this.modal=new M.u,this.podeResetar=!0}ngOnDestroy(){this.subscription.forEach(t=>t.unsubscribe())}ngAfterViewInit(){this.modal.id=0,this.modal.template=this.template,this.modal.icon=this.icon,this.modal.style={"max-width":"500px",overflow:"visible"},this.modal.activatedRoute=this.activatedRoute,this.modal.routerBackOptions={relativeTo:this.activatedRoute},this.modal.title="Resetar Senha",this.modal.routerBack=["../../"];var t=this.activatedRoute.params.subscribe(s=>{s.usuario_id?(this.objeto.id=this.crypto.decrypt(s.usuario_id),(0,g.n)(this.usuarioService.get(this.objeto.id)).then(o=>{this.objeto=o;var a=this.accountService.accountValue;a?.perfilAcesso_Id==v.uU.Master&&o.perfilAcesso_Id==v.uU.Admin&&(this.toastr.info("Voc\xea n\xe3o tem permiss\xe3o para resetar a senha de uma conta administradora."),this.erro="Voc\xea n\xe3o tem permiss\xe3o para resetar a senha de uma conta administradora.",this.podeResetar=!1),setTimeout(()=>{this.modal=this.modalService.addModal(this.modal,"usuario")},200)}).catch(o=>{this.voltar()})):this.voltar()});this.subscription.push(t)}voltar(){this.modalService.removeModal(this.modal)}send(){this.loading=!0,(0,g.n)(this.usuarioService.resetPassword(this.objeto.id)).then(t=>{this.voltar(),this.toastr.success("Opera\xe7\xe3o conclu\xedda com sucesso"),this.alertService.success("O usu\xe1rio deve verificar a caixa de e-mail para seguir as instru\xe7\xf5es."),this.objeto.email==this.userLogado?.email&&this.accountService.logout()}).catch().finally(()=>this.loading=!1)}static#e=this.\u0275fac=function(s){return new(s||i)(e.Y36(f.gz),e.Y36(h),e.Y36(n.B),e.Y36(u.w),e.Y36(c._W),e.Y36(M.Z),e.Y36(Ue.c))};static#t=this.\u0275cmp=e.Xpm({type:i,selectors:[["app-reset-password"]],viewQuery:function(s,o){if(1&s&&(e.Gf(ye,5),e.Gf(we,5)),2&s){let a;e.iGM(a=e.CRH())&&(o.template=a.first),e.iGM(a=e.CRH())&&(o.icon=a.first)}},decls:5,vars:0,consts:[["icon",""],["template",""],[3,"icon"],[4,"ngIf"],["class","text-danger",4,"ngIf"],[1,"btn","btn-grey","ms-auto","d-flex","mt-2",3,"click"],["class","spinner-border spinner-border-sm me-1",4,"ngIf"],[1,"text-danger"],[1,"spinner-border","spinner-border-sm","me-1"]],template:function(s,o){1&s&&(e.YNc(0,Oe,1,1,"ng-template",null,0,e.W1O),e.YNc(2,Le,2,2,"ng-template",null,1,e.W1O),e._UZ(4,"router-outlet"))},dependencies:[T.O5,f.lC,y.BN]})}return i})();const je=["template"];function Pe(i,r){1&i&&(e.TgZ(0,"span",7),e._uU(1,"habilitar"),e.qZA())}function qe(i,r){1&i&&(e.TgZ(0,"span",7),e._uU(1,"desabilitar"),e.qZA())}function Be(i,r){1&i&&(e.TgZ(0,"p",8),e._uU(1,"Voc\xea automaticamente ser\xe1 deslogado e n\xe3o poder\xe1 acessar o Planner."),e.qZA())}function Ge(i,r){1&i&&(e.TgZ(0,"p",8),e._uU(1,"Ap\xf3s isso, o usu\xe1rio n\xe3o poder\xe1 acessar o Planner."),e.qZA())}function He(i,r){if(1&i&&(e.TgZ(0,"p",8),e._uU(1),e.qZA()),2&i){const t=e.oxw(3);e.xp6(1),e.Oqu(t.erro)}}function Ve(i,r){1&i&&e._UZ(0,"span",9)}function We(i,r){1&i&&(e.TgZ(0,"span"),e._uU(1,"Desabilitar"),e.qZA())}function Ke(i,r){1&i&&(e.TgZ(0,"span"),e._uU(1,"Habilitar"),e.qZA())}function $e(i,r){if(1&i){const t=e.EpF();e.TgZ(0,"div")(1,"p"),e._uU(2,"Tem certeza que deseja "),e.YNc(3,Pe,2,0,"span",3),e.YNc(4,qe,2,0,"span",3),e._uU(5," esse registro? "),e.qZA(),e.YNc(6,Be,2,0,"p",4),e.YNc(7,Ge,2,0,"p",4),e.YNc(8,He,2,1,"p",4),e.TgZ(9,"button",5),e.NdJ("click",function(){e.CHM(t);const o=e.oxw(2);return e.KtG(o.send())}),e.YNc(10,Ve,1,0,"span",6),e.YNc(11,We,2,0,"span",1),e.YNc(12,Ke,2,0,"span",1),e.qZA()()}if(2&i){const t=e.oxw(2);e.xp6(3),e.Q6J("ngIf",t.habilitar),e.xp6(1),e.Q6J("ngIf",!t.habilitar),e.xp6(2),e.Q6J("ngIf",t.isUser&&t.habilitar&&t.objeto.email==(null==t.account?null:t.account.email)),e.xp6(1),e.Q6J("ngIf",t.isUser&&t.habilitar&&t.objeto.email!=(null==t.account?null:t.account.email)),e.xp6(1),e.Q6J("ngIf",t.erro),e.xp6(2),e.Q6J("ngIf",t.loading),e.xp6(1),e.Q6J("ngIf",!t.habilitar),e.xp6(1),e.Q6J("ngIf",t.habilitar)}}function ze(i,r){if(1&i&&(e.TgZ(0,"div",10)(1,"p",8),e._uU(2),e.qZA()()),2&i){const t=e.oxw(2);e.xp6(2),e.Oqu(t.erro)}}function Xe(i,r){if(1&i&&(e.YNc(0,$e,13,8,"div",1),e.YNc(1,ze,3,1,"div",2)),2&i){const t=e.oxw();e.Q6J("ngIf",t.podeAtivar),e.xp6(1),e.Q6J("ngIf",!t.podeAtivar)}}let B=(()=>{class i{constructor(t,s,o,a,p,A){this.usuarioService=t,this.modalService=s,this.activatedRoute=o,this.crypto=a,this.accountService=p,this.toastr=A,this.objeto=new U,this.loading=!1,this.erro="",this.subscription=[],this.modal=new M.u,this.podeAtivar=!0,this.habilitar=!1,this.isUser=!1,this.account=this.accountService.accountValue}ngOnDestroy(){this.subscription.forEach(t=>t.unsubscribe())}ngAfterViewInit(){this.modal.id=0,this.modal.template=this.template,this.modal.style={"max-width":"400px",overflow:"visible"},this.modal.activatedRoute=this.activatedRoute,this.modal.routerBackOptions={relativeTo:this.activatedRoute};var t=this.activatedRoute.params.subscribe(s=>{s.usuario_id?(this.objeto.id=this.crypto.decrypt(s.usuario_id),this.isUser=this.account?.id==this.objeto.id,this.modal.routerBack=["../../"],(0,g.n)(this.usuarioService.get(this.objeto.id)).then(o=>{this.objeto=o,this.habilitar=!(null==this.objeto.dataDesativado||null==this.objeto.dataDesativado),this.objeto.ativo=!this.habilitar;var a=this.accountService.accountValue;if(this.modal.title=this.habilitar?"Habilitar Usu\xe1rio":"Desabilitar Usu\xe1rio",a?.perfilAcesso_Id==v.uU.Master&&o.perfilAcesso_Id==v.uU.Admin){this.podeAtivar=!1;var p=this.habilitar?"habilitar":"desabilitar";this.toastr.info(`Voc\xea n\xe3o tem permiss\xe3o para ${p} uma conta administradora.`),this.erro=`Voc\xea n\xe3o tem permiss\xe3o para ${p} uma conta administradora.`}setTimeout(()=>{this.modal=this.modalService.addModal(this.modal,"usuario")},200)}).catch(o=>{this.voltar()})):this.voltar()});this.subscription.push(t)}voltar(){this.modalService.removeModal(this.modal)}send(){var t=this;this.loading=!0,this.erro="",(0,g.n)(this.usuarioService.deactivated(this.objeto.id,this.habilitar)).then(function(){var s=(0,R.Z)(function*(o){t.habilitar&&t.isUser&&t.accountService.logout(),yield(0,g.n)(t.usuarioService.getList()),t.voltar()});return function(o){return s.apply(this,arguments)}}()).finally(()=>this.loading=!1)}static#e=this.\u0275fac=function(s){return new(s||i)(e.Y36(h),e.Y36(M.Z),e.Y36(f.gz),e.Y36(u.w),e.Y36(n.B),e.Y36(c._W))};static#t=this.\u0275cmp=e.Xpm({type:i,selectors:[["app-deactivated"]],viewQuery:function(s,o){if(1&s&&e.Gf(je,5),2&s){let a;e.iGM(a=e.CRH())&&(o.template=a.first)}},decls:3,vars:0,consts:[["template",""],[4,"ngIf"],["class","mb-2",4,"ngIf"],["class","font-weight-bold",4,"ngIf"],["class","text-danger",4,"ngIf"],[1,"btn","btn-grey","ms-auto","d-flex","mt-2",3,"click"],["class","spinner-border spinner-border-sm me-1",4,"ngIf"],[1,"font-weight-bold"],[1,"text-danger"],[1,"spinner-border","spinner-border-sm","me-1"],[1,"mb-2"]],template:function(s,o){1&s&&(e.YNc(0,Xe,2,2,"ng-template",null,0,e.W1O),e._UZ(2,"router-outlet"))},dependencies:[T.O5,f.lC]})}return i})();var ke=l(9742);const et=[{path:"",component:X,children:[{path:"cadastrar",component:q,data:{modalOrder:1},title:"Zentech - Cadastrar usu\xe1rio"},{path:"editar/:usuario_id",component:q,data:{modalOrder:1},title:"Zentech - Editar usu\xe1rio",canActivate:[x]},{path:"excluir/:usuario_id",component:Se,data:{modalOrder:1,roles:[v.uU.Admin]},title:"Zentech - Excluir usu\xe1rio",canActivate:[x,ke.p]},{path:"reset-password/:usuario_id",component:Re,data:{modalOrder:1},title:"Zentech - Resetar senha",canActivate:[x]},{path:"habilitar/:usuario_id",component:B,data:{modalOrder:1},title:"Zentech - Habilitar usu\xe1rio",canActivate:[x]},{path:"desabilitar/:usuario_id",component:B,data:{modalOrder:1},title:"Zentech - Desabilitar usu\xe1rio",canActivate:[x]},Ie.D]}];let tt=(()=>{class i{static#e=this.\u0275fac=function(s){return new(s||i)};static#t=this.\u0275mod=e.oAB({type:i});static#i=this.\u0275inj=e.cJS({imports:[f.Bz.forChild(et),f.Bz]})}return i})();var it=l(9227);let st=(()=>{class i{static#e=this.\u0275fac=function(s){return new(s||i)};static#t=this.\u0275mod=e.oAB({type:i});static#i=this.\u0275inj=e.cJS({imports:[T.ez,tt,it.m,y.uH,b.u5]})}return i})()},9901:(G,O,l)=>{l.d(O,{j:()=>L});var T=l(5861),J=l(708),v=l(490),e=l(5038),n=l(9291),Y=l(6434),S=l(6814),I=l(6223),D=l(5219),d=l(2352);function C(m,E){if(1&m&&(n.TgZ(0,"span"),n._uU(1),n.qZA()),2&m){const c=n.oxw(3);n.xp6(1),n.Oqu(null==c.empresaSelected.empresa?null:c.empresaSelected.empresa.nome)}}function U(m,E){if(1&m&&n.YNc(0,C,2,1,"span",7),2&m){const c=n.oxw(2);n.Q6J("ngIf",c.empresaSelected.id)}}function j(m,E){if(1&m&&(n.TgZ(0,"p"),n._uU(1),n.qZA(),n.TgZ(2,"p"),n._uU(3),n.qZA()),2&m){const c=E.$implicit;n.xp6(1),n.Oqu(c.nome),n.xp6(2),n.Oqu(c.logo)}}function Q(m,E){if(1&m){const c=n.EpF();n.TgZ(0,"div",1)(1,"label",2),n._uU(2,"Selecione a Empresa para carregar dados"),n.qZA(),n.TgZ(3,"p-dropdown",3,4),n.NdJ("ngModelChange",function(_){n.CHM(c);const h=n.oxw();return n.KtG(h.empresaChange(_))})("ngModelChange",function(_){n.CHM(c);const h=n.oxw();return n.KtG(h.empresaSelected.id=_)}),n.YNc(5,U,1,1,"ng-template",5),n.YNc(6,j,4,2,"ng-template",6),n.qZA()()}if(2&m){const c=n.oxw();n.xp6(3),n.Q6J("options",c.empresas)("ngModel",c.empresaSelected.id)("filter",!0)("showClear",!1)("required",!0)}}let L=(()=>{class m{constructor(c,u){this.empresaService=c,this.accountService=u,this.empresaSelected=new e.I,this.empresas=[],this.loading=!1,this.Role=v.uU,this.subscription=[];var _=this.accountService.accountSubject.subscribe(x=>{this.account=x,this.empresaService.empresaSelected.next({id:x?.empresa_Id,empresa:x?.empresa})});this.subscription.push(_);var h=this.empresaService.empresaSelected.subscribe(x=>this.empresaSelected=x);this.subscription.push(h);var f=this.empresaService.list.subscribe(x=>this.empresas=x);this.subscription.push(f)}ngOnDestroy(){this.subscription.forEach(c=>c.unsubscribe())}empresaChange(c){var u=this;return(0,T.Z)(function*(){if(u.accountService.accountValue&&1==u.accountService.accountValue?.perfilAcesso_Id&&c){0==u.empresas.length&&(yield(0,J.n)(u.empresaService.getList()));var _=u.empresas.find(h=>h.id==c);u.empresaService.empresaSelected.next({empresa:_,id:c})}})()}static#e=this.\u0275fac=function(u){return new(u||m)(n.Y36(e.P),n.Y36(Y.B))};static#t=this.\u0275cmp=n.Xpm({type:m,selectors:[["app-empresa-selected"]],decls:1,vars:1,consts:[["class","form-group ms-2",4,"ngIf"],[1,"form-group","ms-2"],["for","empresa_Id"],["name","empresa_Id","id","empresa_Id","optionValue","id","filterBy","nome","styleClass","form-control","placeholder","Selecione uma empresa",3,"options","ngModel","filter","showClear","required","ngModelChange"],["empresa_Id","ngModel"],["pTemplate","selectedItem"],["pTemplate","item"],[4,"ngIf"]],template:function(u,_){1&u&&n.YNc(0,Q,7,5,"div",0),2&u&&n.Q6J("ngIf",_.account&&1==(null==_.account?null:_.account.perfilAcesso_Id))},dependencies:[S.O5,I.JJ,I.Q7,I.On,D.jx,d.Lt]})}return m})()}}]);